"use strict";const e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],t=(e,...t)=>{e.classList.remove(...t),e.offsetWidth,e.classList.add(...t)};function n(t){const n=function(e){const t=Math.log(e/440)/Math.log(2)*12;return Math.round(t)+69}(t);return{value:n%12,index:n,name:e[n%12],cents:o(t,n),octave:Math.trunc(n/12)-1,frequency:t}}function o(e,t){return Math.floor(1200*Math.log(e/function(e){return 440*Math.pow(2,(e-69)/12)}(t))/Math.log(2))}Aubio().then((({Pitch:e})=>{var o,i,r,a;if(function(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,!window.AudioContext)return alert("AudioContext not supported");void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){const t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t||alert("getUserMedia is not implemented in this browser"),new Promise((function(n,o){t.call(navigator,e,n,o)}))})}(),!("WebAssembly"in window&&"AudioContext"in window&&"createAnalyser"in AudioContext.prototype&&"createScriptProcessor"in AudioContext.prototype&&"trunc"in Math))return alert("Browser not supported");const d=null===(o=document.getElementById("pitch-wheel"))||void 0===o?void 0:o.querySelector("svg"),c=null===(i=document.getElementById("pitch-freq"))||void 0===i?void 0:i.querySelector(".freq"),s=null===(r=document.getElementById("pitch-freq"))||void 0===r?void 0:r.querySelector(".note"),l=null===(a=document.getElementById("pitch-freq"))||void 0===a?void 0:a.querySelector(".octave"),u=document.getElementById("audio-start"),m=document.getElementById("audio-pause"),y=document.getElementById("pitch-freq-text"),v=document.querySelector(".audio-block-2");if(!(d&&c&&s&&l&&u&&m&&y))return;let p,g,f,h;m.addEventListener("click",(()=>{f.disconnect(p.destination),g.disconnect(f),p.close(),u.style.display="block",m.style.display="none",y.style.display="none",t(u,"blob-animation")})),u.addEventListener("click",(()=>{p=new AudioContext,g=p.createAnalyser(),f=p.createScriptProcessor(4096,1,1),h=new e("default",4096,1,p.sampleRate),navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{p.createMediaStreamSource(e).connect(g),g.connect(f),f.connect(p.destination),u.style.display="none",m.style.display="block",y.style.display="block",v&&(v.style.display="none"),t(m,"shrink-animation");let o=0;f.addEventListener("audioprocess",(e=>{const t=n(h.do(e.inputBuffer.getChannelData(0))),i=15*t.index+t.cents/100*15;if(t.name){const e=Math.trunc(Math.abs(o-i));o=i;const n=15*(e+25);c.innerText=t.frequency.toFixed(1),s.innerText=t.name,l.innerText=t.octave.toString(),d.style.transition=`transform ${n}ms ease`,d.style.transform=`rotate(-${i}deg)`}}))}))}))}));
//# sourceMappingURL=index.js.map
